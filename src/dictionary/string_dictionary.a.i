// string_dictionary.a.i - String dictionary for Anarchy Agent
// Implements centralized string storage to minimize token usage

// String Dictionary Module Definition
ŒªStringDictionary {
    // Initialize string dictionary
    ∆íinitialize(Œ±options) {
        ‚åΩ("Initializing string dictionary...");
        
        // Set default options
        Œπthis.options = options || {};
        Œπthis.options.default_dict = this.options.default_dict || "default";
        Œπthis.options.dict_dir = this.options.dict_dir || "./dictionaries";
        
        // Initialize dictionaries
        Œπthis.dictionaries = {};
        Œπthis.active_dict = this.options.default_dict;
        
        // Create dictionary directory if it doesn't exist
        √∑{
            Œπexists = ?(this.options.dict_dir);
            if (!exists) {
                !(`mkdir -p ${this.options.dict_dir}`);
            }
        }{
            ‚åΩ("Failed to create dictionary directory");
        }
        
        // Create default dictionary
        this.dictionaries[this.active_dict] = {};
        
        // Load dictionaries from files if they exist
        this._load_dictionaries();
        
        ‚üº(‚ä§);
    }
    
    // Set string in dictionary
    ∆íset(œÉkey, œÉvalue, œÉdict_name) {
        Œπdict = dict_name || this.active_dict;
        
        // Create dictionary if it doesn't exist
        if (!this.dictionaries[dict]) {
            this.dictionaries[dict] = {};
        }
        
        // Set string in dictionary
        this.dictionaries[dict][key] = value;
        
        // Persist dictionary to disk
        this._persist_dictionary(dict);
        
        ‚üº(‚ä§);
    }
    
    // Get string from dictionary
    ∆íget(œÉkey, œÉdict_name) {
        Œπdict = dict_name || this.active_dict;
        
        // Check if dictionary exists
        if (!this.dictionaries[dict]) {
            ‚åΩ(`Dictionary not found: ${dict}`);
            ‚üº(null);
        }
        
        // Get string from dictionary
        Œπvalue = this.dictionaries[dict][key];
        
        // Return value or null if not found
        ‚üº(value !== undefined ? value : null);
    }
    
    // Format string with placeholders
    ∆íformat(œÉkey, ...Œ±args) {
        Œπvalue = this.get(key);
        
        if (!value) {
            ‚üº(null);
        }
        
        // Replace {} placeholders with arguments
        Œπformatted = value;
        ‚àÄ(args, Œªarg {
            formatted = formatted.replace("{}", arg);
        });
        
        ‚üº(formatted);
    }
    
    // Switch active dictionary
    ∆íswitch_dictionary(œÉdict_name) {
        // Check if dictionary exists
        if (!this.dictionaries[dict_name]) {
            // Create new dictionary
            this.dictionaries[dict_name] = {};
        }
        
        // Switch active dictionary
        this.active_dict = dict_name;
        
        ‚üº(‚ä§);
    }
    
    // Load dictionary from file
    ∆íload_from_file(œÉfilename, œÉdict_name) {
        Œπdict = dict_name || this.active_dict;
        
        √∑{
            // Get full path
            Œπfull_path = `${this.options.dict_dir}/${filename}`;
            
            // Check if file exists
            Œπexists = ?(full_path);
            if (!exists) {
                ‚åΩ(`Dictionary file not found: ${filename}`);
                ‚üº(‚ä•);
            }
            
            // Read file content
            Œπcontent = üìñ(full_path);
            
            // Parse JSON content
            Œπparsed = ‚éã(content);
            
            // Create dictionary if it doesn't exist
            if (!this.dictionaries[dict]) {
                this.dictionaries[dict] = {};
            }
            
            // Merge parsed content with existing dictionary
            ‚àÄ(Object.keys(parsed), Œªkey {
                this.dictionaries[dict][key] = parsed[key];
            });
            
            ‚üº(‚ä§);
        }{
            ‚åΩ(`Failed to load dictionary from file: ${filename}`);
            ‚üº(‚ä•);
        }
    }
    
    // Save dictionary to file
    ∆ísave_to_file(œÉfilename, œÉdict_name) {
        Œπdict = dict_name || this.active_dict;
        
        √∑{
            // Check if dictionary exists
            if (!this.dictionaries[dict]) {
                ‚åΩ(`Dictionary not found: ${dict}`);
                ‚üº(‚ä•);
            }
            
            // Get full path
            Œπfull_path = `${this.options.dict_dir}/${filename}`;
            
            // Create directory if it doesn't exist
            Œπdir_path = full_path.substring(0, full_path.lastIndexOf("/"));
            Œπdir_exists = ?(dir_path);
            if (!dir_exists) {
                !(`mkdir -p ${dir_path}`);
            }
            
            // Convert dictionary to JSON
            Œπcontent = ‚éã(this.dictionaries[dict]);
            
            // Write content to file
            ‚úç(full_path, content);
            
            ‚üº(‚ä§);
        }{
            ‚åΩ(`Failed to save dictionary to file: ${filename}`);
            ‚üº(‚ä•);
        }
    }
    
    // Get all keys in a dictionary
    ∆íget_keys(œÉdict_name) {
        Œπdict = dict_name || this.active_dict;
        
        // Check if dictionary exists
        if (!this.dictionaries[dict]) {
            ‚åΩ(`Dictionary not found: ${dict}`);
            ‚üº([]);
        }
        
        // Return array of keys
        ‚üº(Object.keys(this.dictionaries[dict]));
    }
    
    // Get all dictionaries
    ∆íget_dictionaries() {
        ‚üº(Object.keys(this.dictionaries));
    }
    
    // Delete a key from dictionary
    ∆ídelete_key(œÉkey, œÉdict_name) {
        Œπdict = dict_name || this.active_dict;
        
        // Check if dictionary exists
        if (!this.dictionaries[dict]) {
            ‚åΩ(`Dictionary not found: ${dict}`);
            ‚üº(‚ä•);
        }
        
        // Delete key from dictionary
        delete this.dictionaries[dict][key];
        
        // Persist dictionary to disk
        this._persist_dictionary(dict);
        
        ‚üº(‚ä§);
    }
    
    // Delete a dictionary
    ∆ídelete_dictionary(œÉdict_name) {
        // Check if dictionary exists
        if (!this.dictionaries[dict_name]) {
            ‚åΩ(`Dictionary not found: ${dict_name}`);
            ‚üº(‚ä•);
        }
        
        // Cannot delete active dictionary
        if (dict_name === this.active_dict) {
            ‚åΩ("Cannot delete active dictionary");
            ‚üº(‚ä•);
        }
        
        // Delete dictionary
        delete this.dictionaries[dict_name];
        
        // Delete dictionary file if it exists
        √∑{
            Œπfull_path = `${this.options.dict_dir}/${dict_name}.json`;
            Œπexists = ?(full_path);
            if (exists) {
                ‚úÇ(full_path);
            }
        }{
            ‚åΩ(`Failed to delete dictionary file: ${dict_name}.json`);
        }
        
        ‚üº(‚ä§);
    }
    
    // Private: Load dictionaries from files
    ∆í_load_dictionaries() {
        √∑{
            // Check if dictionary directory exists
            Œπexists = ?(this.options.dict_dir);
            if (!exists) {
                ‚üº(‚ä•);
            }
            
            // List files in dictionary directory
            Œπfiles = üìÇ(this.options.dict_dir);
            
            // Load each dictionary file
            ‚àÄ(files, Œªfile {
                if (file.endsWith(".json")) {
                    Œπdict_name = file.substring(0, file.length - 5);
                    this.load_from_file(file, dict_name);
                }
            });
            
            ‚üº(‚ä§);
        }{
            ‚åΩ("Failed to load dictionaries from files");
            ‚üº(‚ä•);
        }
    }
    
    // Private: Persist dictionary to disk
    ∆í_persist_dictionary(œÉdict_name) {
        √∑{
            // Save dictionary to file
            this.save_to_file(`${dict_name}.json`, dict_name);
            ‚üº(‚ä§);
        }{
            ‚åΩ(`Failed to persist dictionary: ${dict_name}`);
            ‚üº(‚ä•);
        }
    }
    
    // Emoji operators for direct use
    // These match the README.md documentation
    
    // üìù (set_string) - Set string in dictionary
    ∆íüìù(œÉkey, œÉvalue, œÉdict_name) {
        ‚üº(this.set(key, value, dict_name));
    }
    
    // üìñ (get_string) - Get string from dictionary
    ∆íüìñ(œÉkey, œÉdict_name) {
        ‚üº(this.get(key, dict_name));
    }
    
    // üî† (load_dictionary) - Load dictionary from file
    ∆íüî†(œÉfilename, œÉdict_name) {
        ‚üº(this.load_from_file(filename, dict_name));
    }
    
    // üíæ (save_dictionary) - Save dictionary to file
    ∆íüíæ(œÉfilename, œÉdict_name) {
        ‚üº(this.save_to_file(filename, dict_name));
    }
    
    // üîÑ (switch_dictionary) - Switch active dictionary
    ∆íüîÑ(œÉdict_name) {
        ‚üº(this.switch_dictionary(dict_name));
    }
}

// Create and initialize the agent string dictionary
Œπagent_dictionary = StringDictionary();
agent_dictionary.initialize();

// Add common strings for the agent
agent_dictionary.üìù("agent_name", "Anarchy Agent");
agent_dictionary.üìù("agent_version", "1.0.0");
agent_dictionary.üìù("agent_description", "A fully local, cross-platform AI assistant using Anarchy-Inference language");

// System messages
agent_dictionary.üìù("system_init", "Initializing Anarchy Agent...");
agent_dictionary.üìù("system_ready", "Anarchy Agent is ready");
agent_dictionary.üìù("system_shutdown", "Shutting down Anarchy Agent...");
agent_dictionary.üìù("system_error", "System error: {}");
agent_dictionary.üìù("system_warning", "Warning: {}");
agent_dictionary.üìù("system_info", "Info: {}");

// Task messages
agent_dictionary.üìù("task_start", "Starting task: {}");
agent_dictionary.üìù("task_complete", "Task completed: {}");
agent_dictionary.üìù("task_failed", "Task failed: {}");
agent_dictionary.üìù("task_progress", "Task progress: {}%");
agent_dictionary.üìù("task_cancelled", "Task cancelled: {}");

// User interaction
agent_dictionary.üìù("user_prompt", "Please enter your request:");
agent_dictionary.üìù("user_input", "User input: {}");
agent_dictionary.üìù("user_response", "Response to user: {}");
agent_dictionary.üìù("user_confirmation", "Please confirm (yes/no):");
agent_dictionary.üìù("user_options", "Please select an option (1-{}):");

// Error messages
agent_dictionary.üìù("error_invalid_input", "Invalid input: {}");
agent_dictionary.üìù("error_permission_denied", "Permission denied: {}");
agent_dictionary.üìù("error_not_found", "Not found: {}");
agent_dictionary.üìù("error_timeout", "Operation timed out: {}");
agent_dictionary.üìù("error_network", "Network error: {}");
agent_dictionary.üìù("error_file_system", "File system error: {}");
agent_dictionary.üìù("error_browser", "Browser error: {}");
agent_dictionary.üìù("error_memory", "Memory error: {}");

// Success messages
agent_dictionary.üìù("success_file_operation", "File operation successful: {}");
agent_dictionary.üìù("success_network_operation", "Network operation successful: {}");
agent_dictionary.üìù("success_browser_operation", "Browser operation successful: {}");
agent_dictionary.üìù("success_memory_operation", "Memory operation successful: {}");

// Help messages
agent_dictionary.üìù("help_general", "Anarchy Agent Help\n\nAvailable commands:\n- task: Execute a task\n- file: File operations\n- web: Web operations\n- memory: Memory operations\n- exit: Exit the agent");
agent_dictionary.üìù("help_task", "Task Help\n\nUsage: task <description>\n\nExecutes a task based on the provided description.");
agent_dictionary.üìù("help_file", "File Help\n\nUsage: file <operation> <arguments>\n\nOperations:\n- list: List directory contents\n- read: Read file content\n- write: Write content to file\n- delete: Delete file or directory\n- copy: Copy file\n- move: Move file");
agent_dictionary.üìù("help_web", "Web Help\n\nUsage: web <operation> <arguments>\n\nOperations:\n- open: Open a web page\n- search: Search the web\n- download: Download a file");
agent_dictionary.üìù("help_memory", "Memory Help\n\nUsage: memory <operation> <arguments>\n\nOperations:\n- store: Store a value\n- retrieve: Retrieve a value\n- delete: Delete a value\n- list: List all keys");

// Save the dictionary to file
agent_dictionary.üíæ("agent_dictionary.json");

// Export the StringDictionary module and initialized dictionary
‚üº({
    StringDictionary: StringDictionary,
    agent_dictionary: agent_dictionary
});
